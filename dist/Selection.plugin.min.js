!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Selection=t()}(this,(function(){"use strict";
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */String(Math.random()).slice(2),document.createComment(""),document.createElement("template"),document.createTextNode("");let e=!1;(()=>{try{const t={get capture(){return e=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){}})(),
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.3");document.createElement("template");class Action{constructor(){this.isAction=!0}}Action.prototype.isAction=!0;document.createTextNode("");
/**
     * Selection plugin
     *
     * @copyright Rafal Pospiech <https://neuronet.io>
     * @author    Rafal Pospiech <neuronet.io@gmail.com>
     * @package   gantt-schedule-timeline-calendar
     * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)
     * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar
     */return function Selection(e={}){let t,i,s,c;const n="config.plugin.selection",o="gantt-schedule-timeline-caledar__plugin-selection-rect",l=document.createElement("div");l.classList.add(o),l.style.visibility="hidden",l.style.left="0px",l.style.top="0px",l.style.width="0px",l.style.height="0px",l.style.background="rgba(0, 119, 192, 0.2)",l.style.border="2px dashed rgba(0, 119, 192, 0.75)",l.style.position="absolute",l.style["user-select"]="none",l.style["pointer-events"]="none";const r={grid:!1,items:!0,rows:!1,horizontal:!0,vertical:!0,rectStyle:{},selecting(){},deselecting(){},selected(){},deselected(){},canSelect:(e,t,i)=>t,canDeselect:(e,t,i)=>[],getApi(){}};e=Object.assign(Object.assign({},r),e);for(const t in e.rectStyle)l.style[t]=e.rectStyle[t];let a={fromX:-1,fromY:-1,toX:-1,toY:-1,startX:-1,startY:-1,startCell:!1,selecting:!1};const d={"chart-timeline-grid-row":e=>e.row.id,"chart-timeline-grid-row-block":e=>e.id,"chart-timeline-items-row":e=>e.row.id,"chart-timeline-items-row-item":e=>e.item.id};class SelectionAction extends Action{constructor(t,s){super();let r,m={};function clearSelection(t=!1){let s;i.update(n,i=>(s={selecting:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]},selected:{"chart-timeline-grid-rows":t?[]:e.canDeselect("chart-timeline-grid-rows",i.selected["chart-timeline-grid-rows"],i),"chart-timeline-grid-row-blocks":t?[]:e.canDeselect("chart-timeline-grid-row-blocks",i.selected["chart-timeline-grid-row-blocks"],i),"chart-timeline-items-rows":t?[]:e.canDeselect("chart-timeline-items-rows",i.selected["chart-timeline-items-rows"],i),"chart-timeline-items-row-items":t?[]:e.canDeselect("chart-timeline-items-rows",i.selected["chart-timeline-items-rows"],i)}},s)),i.update("_internal.chart.grid.rowsWithBlocks",(function clearRowsWithBlocks(e){if(e)for(const t of e)for(const e of t.blocks)e.selected=s.selected["chart-timeline-grid-row-blocks"].includes(e.id),e.selecting=!1;return e}))}this.unsub=s.state.subscribeAll(["_internal.elements.chart-timeline","_internal.chart.dimensions.width"],e=>{const t=i.get("_internal.elements.chart-timeline");if(void 0===t)return;this.chartTimeline=t,this.chartTimeline.querySelector("."+o)||this.chartTimeline.insertAdjacentElement("beforeend",l);const s=this.chartTimeline.getBoundingClientRect();this.left=s.left,this.top=s.top}),m.clearSelection=clearSelection;const saveAndSwapIfNeeded=e=>{const t=e.x-this.left,i=e.y-this.top;t<=a.startX?(a.fromX=t,a.toX=a.startX):(a.fromX=a.startX,a.toX=t),i<=a.startY?(a.fromY=i,a.toY=a.startY):(a.fromY=a.startY,a.toY=i)},isInside=(e,t)=>{let i=!1,s=!1;return(e.left>t.left&&e.left<t.right||e.right>t.left&&e.right<t.right||e.left<=t.left&&e.right>=t.right)&&(i=!0),(e.top>t.top&&e.top<t.bottom||e.bottom>t.top&&e.bottom<t.bottom||e.top<=t.top&&e.bottom>=t.bottom)&&(s=!0),i&&s},getSelecting=(t,s,c,o)=>{const l=[],r=[],a=s[c+"s"];if(!a)return[];const d=i.get(n),m=d.selecting[c+"s"];for(const i of a){const s=i.getBoundingClientRect();if(isInside(s,t)){r.push(i.vido),e.canSelect(c,r,d).includes(i.vido)?(m.includes(o(i.vido))||e.selecting(i.vido,c),l.push(o(i.vido))):r.unshift()}else m.includes(o(i.vido))&&e.deselecting(i.vido,c)}return l},endSelect=t=>{if(!a.selecting)return void clearSelection();if(t.stopPropagation(),a.fromX===t.x-this.left&&a.fromY===t.y-this.top)return a.selecting=!1,void(l.style.visibility="hidden");a.selecting=!1,l.style.visibility="hidden";const s=i.get(n),c={};i.update(n,e=>(c.selected=Object.assign({},e.selecting),c.selecting={"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]},c));const o=i.get("_internal.elements");for(const t in d)if(o[t+"s"])for(const i of o[t+"s"])s.selecting[t+"s"].includes(i.vido.id)&&e.deselecting(i.vido,t);i.update("config.chart.items",(function updateItems(e){const t=s.selecting["chart-timeline-items-row-items"];for(const i in e){const s=e[i];t.includes(s.id)?s.selecting=!0:s.selecting=!1}return e})),i.update("_internal.chart.grid.rowsWithBlocks",(function updateRowsWithBlocks(t){if(t)for(const i of t)for(const t of i.blocks)s.selecting["chart-timeline-grid-row-blocks"].includes(t.id)?(void 0!==t.selected&&t.selected||e.selected(t,"chart-timeline-grid-row-block"),t.selected=!0):(r.selected["chart-timeline-grid-row-blocks"].includes(t.id)&&e.deselected(t,"chart-timeline-grid-row-block"),t.selected=!1);return t}))};this.mouseDown=e=>{0===e.button&&(a.selecting=!0,a.fromX=e.x-this.left,a.fromY=e.y-this.top,a.startX=a.fromX,a.startY=a.fromY,r=function cloneSelection(e){const t={};return t.selecting=Object.assign({},e.selecting),t.selecting["chart-timeline-grid-rows"]=e.selecting["chart-timeline-grid-rows"].slice(),t.selecting["chart-timeline-grid-row-blocks"]=e.selecting["chart-timeline-grid-row-blocks"].slice(),t.selecting["chart-timeline-items-rows"]=e.selecting["chart-timeline-items-rows"].slice(),t.selecting["chart-timeline-items-row-items"]=e.selecting["chart-timeline-items-row-items"].slice(),t.selected=Object.assign({},e.selected),t.selected["chart-timeline-grid-rows"]=e.selected["chart-timeline-grid-rows"].slice(),t.selected["chart-timeline-grid-row-blocks"]=e.selected["chart-timeline-grid-row-blocks"].slice(),t.selected["chart-timeline-items-rows"]=e.selected["chart-timeline-items-rows"].slice(),t.selected["chart-timeline-items-row-items"]=e.selected["chart-timeline-items-row-items"].slice(),t}(i.get(n)),clearSelection())},this.mouseMove=e=>{(e=>{if(!a.selecting)return;clearSelection(),saveAndSwapIfNeeded(e),l.style.left=a.fromX+"px",l.style.top=a.fromY+"px",l.style.visibility="visible",l.style.width=a.toX-a.fromX+"px",l.style.height=a.toY-a.fromY+"px";const t=l.getBoundingClientRect(),s=i.get("_internal.elements"),c={};for(const e in d)c[e+"s"]=getSelecting(t,s,e,d[e]);i.update(`${n}.selecting`,c),i.update("config.chart.items",(function updateItems(e){const t=c["chart-timeline-items-row-items"];for(const i in e){const s=e[i];t.includes(s.id)?s.selecting=!0:s.selecting=!1}return e}),{only:["selecting"]}),i.update("_internal.chart.grid.rowsWithBlocks",(function updateRowsWithBlocks(e){const t=c["chart-timeline-grid-row-blocks"],i=c["chart-timeline-grid-rows"];if(e)for(const s of e){i.includes(s.id)?s.selecting=!0:s.selecting=!1;for(const e of s.blocks)t.includes(e.id)?e.selecting=!0:e.selecting=!1}return e}))})(e)},this.mouseUp=e=>{a.selecting&&endSelect(e)},t.addEventListener("mousedown",this.mouseDown),document.addEventListener("mousemove",c(this.mouseMove)),document.addEventListener("mouseup",this.mouseUp),e.getApi(m)}destroy(e){document.removeEventListener("mouseup",this.mouseUp),document.removeEventListener("mousemove",this.mouseMove),e.removeEventListener("mousedown",this.mouseDown)}}function updateSelection(e,t,i,s,c){t&&!e.classList.contains(s)?e.classList.add(s):!t&&e.classList.contains(s)&&e.classList.remove(s),i&&!e.classList.contains(c)?e.classList.add(c):!i&&e.classList.contains(c)&&e.classList.remove(c)}class GridBlockAction extends Action{constructor(e,t){super(),this.classNameSelecting=s.getClass("chart-timeline-grid-row-block")+"--selecting",this.classNameSelected=s.getClass("chart-timeline-grid-row-block")+"--selected",updateSelection(e,t.selecting,t.selected,this.classNameSelecting,this.classNameSelected)}update(e,t){updateSelection(e,t.selecting,t.selected,this.classNameSelecting,this.classNameSelected)}destroy(e,t){e.classList.remove(this.classNameSelecting),e.classList.remove(this.classNameSelected)}}class ItemAction extends Action{constructor(e,t){super(),this.classNameSelecting=s.getClass("chart-timeline-items-row-item")+"--selecting",this.classNameSelected=s.getClass("chart-timeline-items-row-item")+"--selected",updateSelection(e,t.item.selecting,t.item.selected,this.classNameSelecting,this.classNameSelected)}update(e,t){updateSelection(e,t.item.selecting,t.item.selected,this.classNameSelecting,this.classNameSelected)}destroy(e,t){e.classList.remove(this.classNameSelecting),e.classList.remove(this.classNameSelected)}}function onBlockCreate(e){const t=i.get("config.plugin.selection.selected.chart-timeline-grid-row-blocks");for(const i of t)if(i===e.id)return e.selected=!0,e;return e.selected=!1,e.selecting=!1,e}return function initialize(e){t=e,i=t.state,s=t.api,c=t.schedule,void 0===i.get(n)&&i.update(n,{selecting:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]},selected:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]}}),i.update("config.chart.items",e=>{for(const t in e){const i=e[t];void 0===i.selecting&&(i.selecting=!1),void 0===i.selected&&(i.selected=!1)}return e}),i.update("config.actions.chart-timeline",e=>(e.push(SelectionAction),e)),i.update("config.actions.chart-timeline-grid-row-block",e=>(e.push(GridBlockAction),e)),i.update("config.actions.chart-timeline-items-row-item",e=>(e.push(ItemAction),e)),i.update("config.chart.grid.block.onCreate",e=>(e.push(onBlockCreate),e))}}}));
//# sourceMappingURL=Selection.plugin.min.js.map
